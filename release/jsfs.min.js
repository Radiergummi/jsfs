(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].slice,r={}.hasOwnProperty,n=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};window.FileSystem=function(){function a(e){this.separateWithFilename=t(this.separateWithFilename,this),this._name=""+e||"undefined",this._getFilesystemObject(),this._cwd=FileSystem.prototype.pathSeparator}var o;return a.prototype.pathSeparator="/",a.prototype.escapeCharacter="\\",a.prototype._cache={},a.prototype._storageName=function(){return""+this._name+"_filesystem"},a.prototype._fileName=function(t){return""+this._name+"_file_"+t},a.prototype._getFilesystemObject=function(){var t;return FileSystem.prototype._cache.hasOwnProperty(this._name)?FileSystem.prototype._cache[this._name]:(t=localStorage.getItem(this._storageName()),null===t&&localStorage.setItem(this._name,JSON.stringify(t={})),FileSystem.prototype._cache[this._name]=t)},a.prototype.getName=function(){return this._name},a.prototype.getCwd=function(){return this._cwd},a.prototype._changeFilesystem=function(t){var e,r,n;n=this._getFilesystemObject(),e=JSON.stringify(n);try{return t(n),localStorage.setItem(this._storageName(),JSON.stringify(n))}catch(a){throw r=a,this._cache[this._name]=JSON.parse(e),r}},o=function(){var t,r,n,a,o,i,s;for(a=arguments[0],o=2<=arguments.length?e.call(arguments,1):[],n="";a.length>0;){for(t=!1,r=i=0,s=o.length-1;s>i;r=i+=2)if(a.slice(0,o[r].length)===o[r]){n+=o[r+1],a=a.slice(o[r].length),t=!0;break}t||(n+=a[0],a=a.slice(1))}return n},a.prototype._splitPath=function(t){var e,r,n,a,i,s,l,p;for(a=FileSystem.prototype.pathSeparator,r=FileSystem.prototype.escapeCharacter,n=t.indexOf(a+a);n>-1;)t=t.slice(0,n)+t.slice(n+a.length),n=t.indexOf(a+a);for(t.slice(0,a.length)===a&&(t=t.slice(a.length)),t.slice(-a.length)===a&&(t=t.slice(0,-a.length)),l=o(t,r+a,a,r+r,r,a,"\n").split("\n"),p=[],i=0,s=l.length;s>i;i++)e=l[i],""!==e&&p.push(e);return p},a.prototype._joinPath=function(t){var e,r,n;return n=FileSystem.prototype.pathSeparator,e=FileSystem.prototype.escapeCharacter,function(){var a,i,s;for(s=[],a=0,i=t.length;i>a;a++)r=t[a],s.push(o(r,n,e+n,e,e+e));return s}().join(n)},a.prototype._toAbsolutePath=function(t,e){var r,n;return n=FileSystem.prototype.pathSeparator,e.slice(0,n.length)===n?e:(r=FileSystem.prototype._joinPath(FileSystem.prototype._splitPath(t).concat(FileSystem.prototype._splitPath(e))),r.slice(0,n.length)!==n&&(r=n+r),r)},a.prototype._toCanonicalPath=function(t){var e,r,n,a,o,i;for(e=[],i=FileSystem.prototype._splitPath(t),a=0,o=i.length;o>a;a++)n=i[a],"."!==n&&(".."===n?e.length>0&&e.pop():e.push(n));return e=FileSystem.prototype._joinPath(e),r=FileSystem.prototype.pathSeparator,e.slice(0,r.length)!==r&&(e=r+e),e},a.prototype._isValidCanonicalPath=function(t){var e,r,n,a,o;for(e=FileSystem.prototype._splitPath(t),n=this._getFilesystemObject(),a=0,o=e.length;o>a;a++)if(r=e[a],n=n[r],!n||n instanceof Array)return!1;return!0},a.prototype.separate=function(t){return FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)))},a.prototype.separateWithFilename=function(t){var e;return e=this.separate(t),{path:e.slice(0,-1),name:e[e.length-1]}},a.prototype.type=function(t){var e,r,n,a,o;for(r=this.separate(t),e=this._getFilesystemObject(),a=0,o=r.length;o>a;a++){if(n=r[a],!e.hasOwnProperty(n))return null;e=e[n]}return e instanceof Array?"file":"folder"},a.prototype.cd=function(t){var e;return null==t&&(t=FileSystem.prototype.pathSeparator),e=FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)),this._isValidCanonicalPath(e)?this._cwd=e:void 0},a.prototype.mkdir=function(t){var e,r,n;null==t&&(t="."),n=this.separate(t);try{return r=!1,this._changeFilesystem(function(t){var e,a,o,i;for(i=[],a=0,o=n.length;o>a;a++)e=n[a],t.hasOwnProperty(e)||(t[e]={},r=!0),i.push(t=t[e]);return i}),r}catch(a){return e=a,!1}},a.prototype.ls=function(t){var e,n,a,o,i,s,l,p;for(null==t&&(t="all"),i=FileSystem.prototype._splitPath(this._cwd),o=this._getFilesystemObject(),l=0,p=i.length;p>l;l++){if(s=i[l],!o.hasOwnProperty(s)||o[s]instanceof Array)throw Error("Invalid current working directory");o=o[s]}return"all"!==t&&"files"!==t||(n=function(){var t;t=[];for(e in o)r.call(o,e)&&o[e]instanceof Array&&t.push(e);return t}(),n.sort(),"files"!==t)?(a=function(){var t;t=[];for(e in o)r.call(o,e)&&(o[e]instanceof Array||t.push(e));return t}(),a.sort(),"all"===t?a.concat(n):a):n},a.prototype._nextAvailableFileNumber=function(){var t,e,a,o,i,s,l,p,h;for(e=[],t=s=0,p=localStorage.length;p>=0?p>s:s>p;t=p>=0?++s:--s)e.push(localStorage.key(t));if(a=[],i=function(t){return function(e){var n,o;null==e&&(e=t._getFilesystemObject());for(n in e)r.call(e,n)&&(o=e[n],o instanceof Array?a.push(o[0]):a=a.concat(i(o)));return a}}(this),o=i().sort(function(t,e){return t-e}),0===o.length)return 0;for(t=l=0,h=o[o.length-1]+1;h>=0?h>=l:l>=h;t=h>=0?++l:--l)if(n.call(o,t)<0)return t},a.prototype.write=function(t,e){var r,n,a,o,i;i=this.separateWithFilename(t),a=i.path,n=i.name,o=!1;try{return this._changeFilesystem(function(t){return function(r){var i,s,l,p,h,c,f;for(c=0,f=a.length;f>c;c++){if(h=a[c],!r.hasOwnProperty(h)||r[h]instanceof Array)throw Error("Invalid folder path");r=r[h]}if(r.hasOwnProperty(n)){if(!(r[n]instanceof Array))throw Error("Cannot write to a folder");p=r[n][0]}else p=t._nextAvailableFileNumber();return i=JSON.stringify(e),s=t._fileName(p),l=localStorage.getItem(s),localStorage.setItem(s,i),r[n]=[p,i.length],o={past:l,name:t._fileName(p),size:i.length}}}(this)),o.size}catch(s){throw r=s,o&&(o.past?localStorage.setItem(o.name,o.past):localStorage.removeItem(o.name)),r}},a.prototype.read=function(t){var e,r,n,a,o,i,s;for(s=this.separateWithFilename(t),n=s.path,r=s.name,e=this._getFilesystemObject(),o=0,i=n.length;i>o;o++){if(a=n[o],!e.hasOwnProperty(a)||e[a]instanceof Array)throw Error("Invalid folder path");e=e[a]}if(!(e.hasOwnProperty(r)&&e[r]instanceof Array))throw Error("No such file in that folder");return JSON.parse(localStorage.getItem(this._fileName(e[r][0])))},a.prototype.size=function(t){var e,r,n,a,o,i,s;for(s=this.separateWithFilename(t),n=s.path,r=s.name,e=this._getFilesystemObject(),o=0,i=n.length;i>o;o++){if(a=n[o],!e.hasOwnProperty(a)||e[a]instanceof Array)return-1;e=e[a]}return e.hasOwnProperty(r)&&e[r]instanceof Array?e[r][1]||-1:-1},a.prototype.append=function(t,e){var r,n,a,o,i;if("string"!=typeof e)throw Error("Can only append strings to a file");i=this.separateWithFilename(t),a=i.path,n=i.name,o=!1;try{return this._changeFilesystem(function(t){return function(r){var i,s,l,p,h,c,f,y;for(f=0,y=a.length;y>f;f++){if(c=a[f],!r.hasOwnProperty(c)||r[c]instanceof Array)throw Error("Invalid folder path");r=r[c]}if(r.hasOwnProperty(n)){if(!(r[n]instanceof Array))throw Error("Cannot append to a folder");if(h=r[n][0],s=JSON.parse(localStorage.getItem(t._fileName(r[n][0]))),"string"!=typeof s)throw Error("Cannot append to a file unless it contains a string");e=s+e}else h=t._nextAvailableFileNumber();return i=JSON.stringify(e),l=t._fileName(h),p=localStorage.getItem(l),localStorage.setItem(l,i),r[n]=[h,i.length],o={past:p,name:t._fileName(h),size:i.length}}}(this)),o.size}catch(s){throw r=s,o&&(o.past?localStorage.setItem(o.name,o.past):localStorage.removeItem(o.name)),r}},a.prototype.rm=function(t){var e,n;return n=this.separateWithFilename(t),t=n.path,(e=n.name)?(this._changeFilesystem(function(n){return function(a){var o,i,s,l,p,h,c,f,y;for(p=0,c=t.length;c>p;p++){if(l=t[p],!a.hasOwnProperty(l)||a[l]instanceof Array)return!1;a=a[l]}if(s=a,!a.hasOwnProperty(e))return!1;for(a=a[e],i=function(t){var e,n;if(t instanceof Array)return[t];n=[];for(e in t)r.call(t,e)&&(n=n.concat(i(t[e])));return n},y=i(a),h=0,f=y.length;f>h;h++)o=y[h],localStorage.removeItem(n._fileName(o[0]));return delete s[e]}}(this)),!0):!1},a}()}).call(this);
//# sourceMappingURL=jsfs.min.js.map