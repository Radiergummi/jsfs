(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].slice,r={}.hasOwnProperty,a=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};window.FileSystem=function(){function n(e){this.rm=t(this.rm,this),this.type=t(this.type,this),this.walkPathAndFile=t(this.walkPathAndFile,this),this.separateWithFilename=t(this.separateWithFilename,this),this._name=""+e||"undefined",this._getFilesystemObject(),this._cwd=FileSystem.prototype.pathSeparator}var i;return n.prototype.pathSeparator="/",n.prototype.escapeCharacter="\\",n.prototype._storageName=function(){return""+this._name+"_filesystem"},n.prototype._fileName=function(t){return""+this._name+"_file_"+t},n.prototype._getFilesystemObject=function(){var t;return t=JSON.parse(localStorage.getItem(this._storageName())),null===t&&this._setFilesystemObject(t={}),t},n.prototype._setFilesystemObject=function(t){var e;try{return localStorage.setItem(this._storageName(),JSON.stringify(t)),!0}catch(r){return e=r,!1}},n.prototype.getName=function(){return this._name},n.prototype.getCwd=function(){return this._cwd},n.prototype._changeFilesystem=function(t){var e,r,a;a=this._getFilesystemObject(),e=JSON.stringify(a);try{return t(a),localStorage.setItem(this._storageName(),JSON.stringify(a))}catch(n){throw r=n,this._cache[this._name]=JSON.parse(e),r}},i=function(){var t,r,a,n,i,o,l;for(n=arguments[0],i=2<=arguments.length?e.call(arguments,1):[],a="";n.length>0;){for(t=!1,r=o=0,l=i.length-1;l>o;r=o+=2)if(n.slice(0,i[r].length)===i[r]){a+=i[r+1],n=n.slice(i[r].length),t=!0;break}t||(a+=n[0],n=n.slice(1))}return a},n.prototype._splitPath=function(t){var e,r,a,n,o,l,s,h;for(n=FileSystem.prototype.pathSeparator,r=FileSystem.prototype.escapeCharacter,a=t.indexOf(n+n);a>-1;)t=t.slice(0,a)+t.slice(a+n.length),a=t.indexOf(n+n);for(t.slice(0,n.length)===n&&(t=t.slice(n.length)),t.slice(-n.length)===n&&(t=t.slice(0,-n.length)),s=i(t,r+n,n,r+r,r,n,"\n").split("\n"),h=[],o=0,l=s.length;l>o;o++)e=s[o],""!==e&&h.push(e);return h},n.prototype._joinPath=function(t){var e,r,a;return a=FileSystem.prototype.pathSeparator,e=FileSystem.prototype.escapeCharacter,function(){var n,o,l;for(l=[],n=0,o=t.length;o>n;n++)r=t[n],l.push(i(r,a,e+a,e,e+e));return l}().join(a)},n.prototype._toAbsolutePath=function(t,e){var r,a;return a=FileSystem.prototype.pathSeparator,e.slice(0,a.length)===a?e:(r=FileSystem.prototype._joinPath(FileSystem.prototype._splitPath(t).concat(FileSystem.prototype._splitPath(e))),r.slice(0,a.length)!==a&&(r=a+r),r)},n.prototype._toCanonicalPath=function(t){var e,r,a,n,i,o;for(e=[],o=FileSystem.prototype._splitPath(t),n=0,i=o.length;i>n;n++)a=o[n],"."!==a&&(".."===a?e.length>0&&e.pop():e.push(a));return e=FileSystem.prototype._joinPath(e),r=FileSystem.prototype.pathSeparator,e.slice(0,r.length)!==r&&(e=r+e),e},n.prototype._isValidCanonicalPath=function(t){var e,r,a,n,i;for(e=FileSystem.prototype._splitPath(t),a=this._getFilesystemObject(),n=0,i=e.length;i>n;n++)if(r=e[n],a=a[r],!a||a instanceof Array)return!1;return!0},n.prototype.separate=function(t){return FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)))},n.prototype.separateWithFilename=function(t){var e;return e=this.separate(t),{path:e.slice(0,-1),name:e[e.length-1]}},n.prototype.walkPath=function(t,e){var r,a,n;for(a=0,n=e.length;n>a;a++){if(r=e[a],!t.hasOwnProperty(r)||t[r]instanceof Array)return null;t=t[r]}return t},n.prototype.walkPathAndFile=function(t,e){return 0===e.length?t:(t=this.walkPath(t,e.slice(0,-1)),t?t[e[e.length-1]]||null:null)},n.prototype.type=function(t){var e,r;return r=this.separate(t),e=this.walkPathAndFile(this._getFilesystemObject(),r),e?e instanceof Array?"file":"folder":null},n.prototype.cd=function(t){var e;return null==t&&(t=FileSystem.prototype.pathSeparator),e=FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)),this._isValidCanonicalPath(e)?this._cwd=e:void 0},n.prototype.mkdir=function(t){var e,r,a;null==t&&(t="."),a=this.separate(t);try{return r=!1,this._changeFilesystem(function(t){var e,n,i,o;for(o=[],n=0,i=a.length;i>n;n++)e=a[n],t.hasOwnProperty(e)||(t[e]={},r=!0),o.push(t=t[e]);return o}),r}catch(n){return e=n,!1}},n.prototype.ls=function(t,e){var a,n,i,o;if(null==t&&(t="."),null==e&&(e="all"),o=this.separate(t),t=this.walkPath(this._getFilesystemObject(),o),!t)throw Error("Invalid folder");return"all"!==e&&"files"!==e||(n=function(){var e;e=[];for(a in t)r.call(t,a)&&t[a]instanceof Array&&e.push(a);return e}(),n.sort(),"files"!==e)?(i=function(){var e;e=[];for(a in t)r.call(t,a)&&(t[a]instanceof Array||e.push(a));return e}(),i.sort(),"all"===e?i.concat(n):i):n},n.prototype._nextAvailableFileNumber=function(){var t,e,n,i,o,l,s,h,p;for(e=[],t=l=0,h=localStorage.length;h>=0?h>l:l>h;t=h>=0?++l:--l)e.push(localStorage.key(t));if(n=[],o=function(t){return function(e){var a,i;null==e&&(e=t._getFilesystemObject());for(a in e)r.call(e,a)&&(i=e[a],i instanceof Array?n.push(i[0]):n=n.concat(o(i)));return n}}(this),i=o().sort(function(t,e){return t-e}),0===i.length)return 0;for(t=s=0,p=i[i.length-1]+1;p>=0?p>=s:s>=p;t=p>=0?++s:--s)if(a.call(i,t)<0)return t},n.prototype.write=function(t,e){var r,a,n,i,o;o=this.separateWithFilename(t),n=o.path,a=o.name,i=!1;try{return this._changeFilesystem(function(t){return function(r){var o,l,s,h,p;if(s=t.walkPath(r,n),!s)throw Error("Invalid folder path");if(s.hasOwnProperty(a)){if(!(s[a]instanceof Array))throw Error("Cannot write to a folder");p=s[a][0]}else p=t._nextAvailableFileNumber();return o=JSON.stringify(e),l=t._fileName(p),h=localStorage.getItem(l),localStorage.setItem(l,o),s[a]=[p,o.length],i={past:h,name:t._fileName(p),size:o.length}}}(this)),i.size}catch(l){throw r=l,i&&(i.past?localStorage.setItem(i.name,i.past):localStorage.removeItem(i.name)),r}},n.prototype.read=function(t){var e;if(e=this.walkPathAndFile(this._getFilesystemObject(),this.separate(t)),!e)throw Error("No such file");return JSON.parse(localStorage.getItem(this._fileName(e[0])))},n.prototype.size=function(t){var e;return e=this.walkPathAndFile(this._getFilesystemObject(),this.separate(t)),(null!=e?e[1]:void 0)||-1},n.prototype.append=function(t,e){var r,a,n,i,o;if("string"!=typeof e)throw Error("Can only append strings to a file");o=this.separateWithFilename(t),n=o.path,a=o.name,i=!1;try{return this._changeFilesystem(function(t){return function(r){var o,l,s,h,p,c;if(h=t.walkPath(r,n),!h)throw Error("Invalid folder path");if(h.hasOwnProperty(a)){if(!(h[a]instanceof Array))throw Error("Cannot append to a folder");if(c=h[a][0],l=JSON.parse(localStorage.getItem(t._fileName(h[a][0]))),"string"!=typeof l)throw Error("Cannot append to a file unless it contains a string");e=l+e}else c=t._nextAvailableFileNumber();return o=JSON.stringify(e),s=t._fileName(c),p=localStorage.getItem(s),localStorage.setItem(s,o),h[a]=[c,o.length],i={past:p,name:t._fileName(c),size:o.length}}}(this)),i.size}catch(l){throw r=l,i&&(i.past?localStorage.setItem(i.name,i.past):localStorage.removeItem(i.name)),r}},n.prototype.rm=function(t){var e,a;return a=this.separateWithFilename(t),t=a.path,(e=a.name)?(this._changeFilesystem(function(a){return function(n){var i,o,l,s,h,p;if(l=a.walkPath(n,t),!l)return!1;if(!l.hasOwnProperty(e))return!1;for(o=function(t){var e,a;if(t instanceof Array)return[t];a=[];for(e in t)r.call(t,e)&&(a=a.concat(o(t[e])));return a},p=o(l[e]),s=0,h=p.length;h>s;s++)i=p[s],localStorage.removeItem(a._fileName(i[0]));return delete l[e]}}(this)),!0):!1},n.prototype.cp=function(t,e){var r,a,n,i,o;if(n=this._getFilesystemObject(),i=this.separate(t),a=this.walkPathAndFile(n,i),!a)return!1;o=null;try{this._changeFilesystem(function(t){return function(r){var n,l,s,h,p,c,u,f,y;if(y=t.separateWithFilename(e),f=y.path,c=y.name,l=t.walkPath(r,f)){if(c){if(l.hasOwnProperty(c)){if(l[c]instanceof Array)return;if(l=l[c],c=i[i.length-1],l.hasOwnProperty(c))return}}else s=sourceName;n=localStorage.getItem(t._fileName(a[0])),u=t._nextAvailableFileNumber(),p=t._fileName(u);try{localStorage.setItem(p,n)}catch(m){return void(h=m)}return o=p,l[c]=[u,n.length]}}}(this))}catch(l){return r=l,o&&localStorage.removeItem(o),!1}return null!==o},n.prototype.mv=function(t,e){var r;try{this._changeFilesystem(function(r){return function(a){var n,i,o,l,s,h,p,c;if(p=r.separateWithFilename(t),l=p.path,o=p.name,s=r.walkPath(a,l),!s||!s.hasOwnProperty(o))throw Error("No such file or folder");if(h=o,c=r.separateWithFilename(e),l=c.path,o=c.name,n=r.walkPath(a,l),i=o,n){if(o){if(n.hasOwnProperty(o)){if(n[i]instanceof Array)return;if(n=n[i],i=h,n.hasOwnProperty(i))return}}else i=h;return n[i]=s[h],delete s[h]}}}(this))}catch(a){return r=a,!1}return!0},n}()}).call(this);
//# sourceMappingURL=jsfs.min.js.map