(function(){var t=[].slice,e={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};window.FileSystem=function(){function o(t){this._name=""+t||"undefined",this._getFilesystemObject(),this._cwd=FileSystem.prototype.pathSeparator}var n;return o.prototype.pathSeparator="/",o.prototype.escapeCharacter="\\",o.prototype._cache={},o.prototype._storageName=function(){return""+this._name+"_filesystem"},o.prototype._fileName=function(t){return""+this._name+"_file_"+t},o.prototype._getFilesystemObject=function(){var t;return FileSystem.prototype._cache.hasOwnProperty(this._name)?FileSystem.prototype._cache[this._name]:(t=localStorage.getItem(this._storageName()),null===t&&localStorage.setItem(this._name,JSON.stringify(t={})),FileSystem.prototype._cache[this._name]=t)},o.prototype.getName=function(){return this._name},o.prototype.getCwd=function(){return this._cwd},o.prototype._changeFilesystem=function(t){var e,r,o;o=this._getFilesystemObject(),e=JSON.stringify(o);try{return t(o),localStorage.setItem(this._storageName(),JSON.stringify(o))}catch(n){throw r=n,this._cache[this._name]=JSON.parse(e),r}},n=function(){var e,r,o,n,a,i,l;for(n=arguments[0],a=2<=arguments.length?t.call(arguments,1):[],o="";n.length>0;){for(e=!1,r=i=0,l=a.length-1;l>i;r=i+=2)if(n.slice(0,a[r].length)===a[r]){o+=a[r+1],n=n.slice(a[r].length),e=!0;break}e||(o+=n[0],n=n.slice(1))}return o},o.prototype._splitPath=function(t){var e,r,o,a,i,l,s,p;for(a=FileSystem.prototype.pathSeparator,r=FileSystem.prototype.escapeCharacter,o=t.indexOf(a+a);o>-1;)t=t.slice(0,o)+t.slice(o+a.length),o=t.indexOf(a+a);for(t.slice(0,a.length)===a&&(t=t.slice(a.length)),t.slice(-a.length)===a&&(t=t.slice(0,-a.length)),s=n(t,r+a,a,r+r,r,a,"\n").split("\n"),p=[],i=0,l=s.length;l>i;i++)e=s[i],""!==e&&p.push(e);return p},o.prototype._joinPath=function(t){var e,r,o;return o=FileSystem.prototype.pathSeparator,e=FileSystem.prototype.escapeCharacter,function(){var a,i,l;for(l=[],a=0,i=t.length;i>a;a++)r=t[a],l.push(n(r,o,e+o,e,e+e));return l}().join(o)},o.prototype._toAbsolutePath=function(t,e){var r,o;return o=FileSystem.prototype.pathSeparator,e.slice(0,o.length)===o?e:(r=FileSystem.prototype._joinPath(FileSystem.prototype._splitPath(t).concat(FileSystem.prototype._splitPath(e))),r.slice(0,o.length)!==o&&(r=o+r),r)},o.prototype._toCanonicalPath=function(t){var e,r,o,n,a,i;for(e=[],i=FileSystem.prototype._splitPath(t),n=0,a=i.length;a>n;n++)o=i[n],"."!==o&&(".."===o?e.length>0&&e.pop():e.push(o));return e=FileSystem.prototype._joinPath(e),r=FileSystem.prototype.pathSeparator,e.slice(0,r.length)!==r&&(e=r+e),e},o.prototype._isValidCanonicalPath=function(t){var e,r,o,n,a;for(e=FileSystem.prototype._splitPath(t),o=this._getFilesystemObject(),n=0,a=e.length;a>n;n++)if(r=e[n],o=o[r],!o||o instanceof Array)return!1;return!0},o.prototype.type=function(t){var e,r,o,n,a;for(r=FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t))),e=this._getFilesystemObject(),n=0,a=r.length;a>n;n++){if(o=r[n],!e.hasOwnProperty(o))return null;e=e[o]}return e instanceof Array?"file":"folder"},o.prototype.cd=function(t){var e;return null==t&&(t=FileSystem.prototype.pathSeparator),e=FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)),this._isValidCanonicalPath(e)?this._cwd=e:void 0},o.prototype.mkdir=function(t){var e,r,o;null==t&&(t="."),o=FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)));try{return r=!1,this._changeFilesystem(function(t){var e,n,a,i;for(i=[],n=0,a=o.length;a>n;n++)e=o[n],t.hasOwnProperty(e)||(t[e]={},r=!0),i.push(t=t[e]);return i}),r}catch(n){return e=n,!1}},o.prototype._nextAvailableFileNumber=function(){var t,o,n,a,i,l,s,p,h;for(o=[],t=l=0,p=localStorage.length;p>=0?p>l:l>p;t=p>=0?++l:--l)o.push(localStorage.key(t));if(n=[],i=function(t){return function(r){var o,a;null==r&&(r=t._getFilesystemObject());for(o in r)e.call(r,o)&&(a=r[o],a instanceof Array?n.push(a[0]):n=n.concat(i(a)));return n}}(this),a=i().sort(function(t,e){return t-e}),0===a.length)return 0;for(t=s=0,h=a[a.length-1]+1;h>=0?h>=s:s>=h;t=h>=0?++s:--s)if(r.call(a,t)<0)return t},o.prototype.write=function(t,e){var r,o,n,a;o=FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t))),n=o[o.length-1],a=!1;try{return this._changeFilesystem(function(t){return function(r){var i,l,s,p,h,y,c,f;for(f=o.slice(0,-1),y=0,c=f.length;c>y;y++){if(h=f[y],!r.hasOwnProperty(h||r[h]instanceof Array))throw Error("Invalid folder path");r=r[h]}if(r.hasOwnProperty(n)){if(!(r[n]instanceof Array))throw Error("Cannot write to a folder");p=r[n][0]}else p=t._nextAvailableFileNumber();return i=JSON.stringify(e),l=t._fileName(p),s=localStorage.getItem(l),localStorage.setItem(l,i),r[n]=[p,i.length],a={past:s,name:t._fileName(p),size:i.length}}}(this)),a.size}catch(i){throw r=i,a&&(a.past?localStorage.setItem(a.name,a.past):localStorage.removeItem(a.name)),r}},o.prototype.read=function(t){var e,r,o,n,a,i,l;for(r=FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t))),o=r[r.length-1],e=this._getFilesystemObject(),l=r.slice(0,-1),a=0,i=l.length;i>a;a++){if(n=l[a],!e.hasOwnProperty(n||e[n]instanceof Array))throw Error("Invalid folder path");e=e[n]}if(!e.hasOwnProperty(o||!(e[o]instanceof Array)))throw Error("No such file in that folder");return JSON.parse(localStorage.getItem(this._fileName(e[o][0])))},o.prototype.size=function(t){var e,r,o,n,a,i,l;for(r=FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t))),o=r[r.length-1],e=this._getFilesystemObject(),l=r.slice(0,-1),a=0,i=l.length;i>a;a++){if(n=l[a],!e.hasOwnProperty(n||e[n]instanceof Array))return-1;e=e[n]}return e.hasOwnProperty(o||!(e[o]instanceof Array))?e[o][1]||-1:-1},o.prototype.append=function(t,e){var r,o,n,a;if("string"!=typeof e)throw Error("Can only append strings to a file");o=FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t))),n=o[o.length-1],a=!1;try{return this._changeFilesystem(function(t){return function(r){var i,l,s,p,h,y,c,f,m;for(m=o.slice(0,-1),c=0,f=m.length;f>c;c++){if(y=m[c],!r.hasOwnProperty(y||r[y]instanceof Array))throw Error("Invalid folder path");r=r[y]}if(r.hasOwnProperty(n)){if(!(r[n]instanceof Array))throw Error("Cannot append to a folder");if(h=r[n][0],l=JSON.parse(localStorage.getItem(t._fileName(r[n][0]))),"string"!=typeof l)throw Error("Cannot append to a file unless it contains a string");e=l+e}else h=t._nextAvailableFileNumber();return i=JSON.stringify(e),s=t._fileName(h),p=localStorage.getItem(s),localStorage.setItem(s,i),r[n]=[h,i.length],a={past:p,name:t._fileName(h),size:i.length}}}(this)),a.size}catch(i){throw r=i,a&&(a.past?localStorage.setItem(a.name,a.past):localStorage.removeItem(a.name)),r}},o}()}).call(this);
//# sourceMappingURL=jsfs.min.js.map