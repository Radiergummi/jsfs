<html>
  <head>
    <title>jsfs GUI Demo</title>
    <script language='javascript' src='../release/jsfs.js'></script>
    <script language='javascript'>
      // Functions for communicating between this shell page and the demo
      // file browser loaded in the iframe:
      function callInDialog () {
          frame.contentWindow.postMessage(
              Array.prototype.slice.apply( arguments ), '*' );
      }
      window.onmessage = function ( e ) {
          if ( e.data[0] == 'buttonClicked' ) {
              if ( e.data[1] == 'Done' ) {
                  alert( 'This is just a demo app.  If it were a real app, '
                       + 'clicking that button would close the dialog.' );
                  return;
              }
              if ( e.data[1] == 'Save' ) {
                  alert( 'This is just a demo app.  If it were a real app, '
                       + 'clicking that button would save a file under "'
                       + e.data[2] + '" in the current folder.' );
                  return;
              }
          }
          console.log( 'page heard this message: ' + e.data );
      }
      // Code to set up a slightly-populated filesystem, containing just a
      // few text files:
      var F = new FileSystem( 'demo' );
      F.mkdir( 'Notes' );
      F.mkdir( 'Essays' );
      F.write( 'Notes/To Do List.txt',
               '\n'
             + 'Things to do before Christmas\n'
             + '-----------------------------\n'
             + '\n'
             + ' * Buy Grandma\'s present\n'
             + ' * Learn to play handbells\n'
             + ' * Break up with Cindy\n' );
      F.write( 'Notes/Favorite quotes.txt',
               'Outside of a dog, a book is a man\'s best friend.  '
             + 'Inside of a dog, it\'s too dark to read. -- Groucho Marx' );
      F.write( 'Essays/On life.txt',
               '[Come back later and put something deep here.]\n'
             + '[Or something witty.  That sells, too.]' );
      F.write( 'Essays/Why I hate cucumbers.txt',
               'Actually, I\'m rather fond of them, which is giving me\n'
             + 'a good case of writer\'s block for this essay.  Argh!\n'
             + 'Perhaps I should write\n'
             + '    "Why I hate \'Why I hate cucumbers\'"\n'
             + 'instead?' );
    </script>
  </head>
  <body>
    <center>
      <div>
        This page is a test.  The section below contains controls for
        changing the state of the frame at the bottom.  The frame at the
        bottom shows the dialog in its current state, and lets you interact
        with it.
      </div>
      <hr/>
      <div id='toolbar'>
        Choose dialog mode:
        <select id='modeSelector'>
          <option value='manage files'>Manage files</option>
          <option value='open file'>Open file</option>
          <option value='save file'>Save file</option>
          <option value='open folder'>Open folder</option>
          <option value='save in folder'>Save in folder</option>
        </select>
      </div>
      <hr/>
      <div id='dialog'>
        <iframe id='frame' src='filedialog.html' width=500 height=300>
        </iframe>
      </div>
    </center>
  </body>
  <script language='javascript'>
    window.onload = function () {
        callInDialog( 'setDialogImitation', true );
    }
    modeSelector.onchange = function () {
        callInDialog( 'setFileBrowserMode',
            modeSelector.options[modeSelector.selectedIndex].value );
    }
  </script>
</html>
